<!-- dashboard.html -->
<div class="dashboard-container">
  <app-shared-header [userType]="'patient'" [userName]="userName"></app-shared-header>

  <!-- Main Content -->
  <main class="dashboard-main">
    <!-- Welcome Section -->
    <section class="welcome-section">
      <h1 class="welcome-title">Welcome back, {{ userName }}</h1>
      <p class="welcome-subtitle">Here's an overview of your health information</p>
    </section>

    <!-- Loading State -->
    <div class="loading-container" *ngIf="loading">
      <div class="spinner"></div>
      <p>Loading your dashboard...</p>
    </div>

    <!-- Dashboard Content -->
    <div *ngIf="!loading">
      <!-- Stats Grid -->
      <section class="stats-grid">
        <div class="stat-card" *ngFor="let stat of stats">
          <div class="stat-header">
            <span class="stat-title">{{ stat.title }}</span>
            <div class="stat-icon-wrapper" [style.background-color]="stat.bgColor">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" [attr.stroke]="stat.iconColor" stroke-width="2">
                <ng-container [ngSwitch]="stat.iconType">
                  <!-- FileText Icon -->
                  <g *ngSwitchCase="'documents'">
                    <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
                    <polyline points="14 2 14 8 20 8"/>
                    <line x1="16" x2="8" y1="13" y2="13"/>
                    <line x1="16" x2="8" y1="17" y2="17"/>
                    <line x1="10" x2="8" y1="9" y2="9"/>
                  </g>
                  <!-- Users Icon -->
                  <g *ngSwitchCase="'doctors'">
                    <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                    <circle cx="9" cy="7" r="4"/>
                    <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                  </g>
                  <!-- Calendar Icon -->
                  <g *ngSwitchCase="'appointments'">
                    <rect width="18" height="18" x="3" y="4" rx="2" ry="2"/>
                    <line x1="16" x2="16" y1="2" y2="6"/>
                    <line x1="8" x2="8" y1="2" y2="6"/>
                    <line x1="3" x2="21" y1="10" y2="10"/>
                  </g>
                  <!-- Activity Icon -->
                  <g *ngSwitchCase="'health'">
                    <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
                  </g>
                </ng-container>
              </svg>
            </div>
          </div>
          <div class="stat-value">{{ stat.value }}</div>
          <div class="stat-subtitle" [style.color]="stat.iconColor">{{ stat.subtitle }}</div>
        </div>
      </section>

      <!-- Main Grid -->
      <div class="main-grid">
        <!-- Recent Documents -->
        <section class="documents-section">
          <div class="section-header">
            <h2 class="section-title">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#2C5F8D" stroke-width="2">
                <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
                <polyline points="14 2 14 8 20 8"/>
              </svg>
              Recent Documents
            </h2>
            <button class="btn-link" (click)="viewAllDocuments()">
              View All
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9 18 15 12 9 6"/>
              </svg>
            </button>
          </div>

          <!-- Documents List -->
          <div class="documents-list" *ngIf="recentDocuments.length > 0">
            <div class="document-item" *ngFor="let doc of recentDocuments" (click)="viewDocument(doc.id)">
              <div class="document-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#4A90E2" stroke-width="2">
                  <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
                  <polyline points="14 2 14 8 20 8"/>
                </svg>
              </div>
              <div class="document-info">
                <h3 class="document-title">{{ doc.title }}</h3>
                <div class="document-meta">
                  <span class="category-badge" 
                        [style.background-color]="doc.categoryColor + '15'" 
                        [style.color]="doc.categoryColor">
                    {{ doc.category }}
                  </span>
                  <span class="document-date">{{ doc.date }}</span>
                </div>
              </div>
              <div class="document-actions">
                <button class="icon-btn-small" (click)="viewDocument(doc.id); $event.stopPropagation()" title="View">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/>
                    <circle cx="12" cy="12" r="3"/>
                  </svg>
                </button>
                <!-- <button class="icon-btn-small" (click)="downloadDocument(doc.id, $event)" title="Download">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="7 10 12 15 17 10"/>
                    <line x1="12" x2="12" y1="15" y2="3"/>
                  </svg>
                </button>
                <button class="icon-btn-small" (click)="showMoreOptions(doc.id, $event)" title="More">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="1"/>
                    <circle cx="12" cy="5" r="1"/>
                    <circle cx="12" cy="19" r="1"/>
                  </svg>
                </button> -->
              </div>
            </div>
          </div>

          <!-- Empty State for Documents -->
          <div class="empty-state-small" *ngIf="recentDocuments.length === 0">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#cbd5e1" stroke-width="2">
              <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
              <polyline points="14 2 14 8 20 8"/>
            </svg>
            <p>No documents yet</p>
            <button class="btn-link" [routerLink]="'/medical-records/upload'">Upload your first document</button>
          </div>
        </section>

        <!-- Health Summary -->
        <aside class="health-summary">
          <h2 class="section-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#2C5F8D" stroke-width="2">
              <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
            </svg>
            Health Summary
          </h2>

          <div class="health-list" *ngIf="healthSummary.length > 0">
            <div class="health-item" *ngFor="let item of healthSummary">
              <div class="health-icon" [style.background-color]="item.iconBg">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" [attr.stroke]="item.iconColor" stroke-width="2">
                  <ng-container [ngSwitch]="item.iconType">
                    <!-- Droplet Icon -->
                    <path *ngSwitchCase="'droplet'" d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"/>
                    <!-- AlertCircle Icon -->
                    <g *ngSwitchCase="'alert'">
                      <circle cx="12" cy="12" r="10"/>
                      <line x1="12" x2="12" y1="8" y2="12"/>
                      <line x1="12" x2="12.01" y1="16" y2="16"/>
                    </g>
                    <!-- Pill Icon -->
                    <g *ngSwitchCase="'pill'">
                      <path d="m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z"/>
                      <path d="m8.5 8.5 7 7"/>
                    </g>
                  </ng-container>
                </svg>
              </div>
              <div class="health-info">
                <div class="health-title">{{ item.title }}</div>
                <div class="health-value">
                  {{ item.value }}
                  <span *ngIf="item.badge" class="health-badge" [style.background-color]="item.badgeColor">
                    {{ item.badge }}
                  </span>
                </div>
              </div>
            </div>
          </div>

          <!-- Action button to complete profile -->
          <button 
            *ngIf="healthSummary.length === 0 || healthSummary[0].title === 'Health Profile'" 
            class="btn-complete-profile"
            [routerLink]="'/account-settings'">
            Complete Your Health Profile
          </button>
        </aside>
      </div>

      <!-- Quick Actions & Health Tip -->
      <div class="bottom-grid">
        <!-- Quick Actions -->
        <section class="quick-actions-section">
          <h2 class="section-title">Quick Actions</h2>
          <div class="quick-actions-list">
            <button class="action-item action-upload" [routerLink]="'/medical-records/upload'">
              <div class="action-icon-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="17 8 12 3 7 8"/>
                  <line x1="12" x2="12" y1="3" y2="15"/>
                </svg>
              </div>
              <span class="action-text">Upload New Document</span>
            </button>
            <button class="action-item action-calendar" [routerLink]="'/findDoctors'">
              <div class="action-icon-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                  <rect width="18" height="18" x="3" y="4" rx="2" ry="2"/>
                  <line x1="16" x2="16" y1="2" y2="6"/>
                  <line x1="8" x2="8" y1="2" y2="6"/>
                  <line x1="3" x2="21" y1="10" y2="10"/>
                </svg>
              </div>
              <span class="action-text">Schedule Appointment</span>
            </button>
            <button class="action-item action-doctor" [routerLink]="'/findDoctors'">
              <div class="action-icon-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                  <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                  <circle cx="9" cy="7" r="4"/>
                  <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
                  <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                </svg>
              </div>
              <span class="action-text">Find a Doctor</span>
            </button>
          </div>
        </section>

        <!-- Health Tip -->
        <section class="health-tip-card" *ngIf="healthTip.visible">
          <h3 class="tip-title">{{ healthTip.title }}</h3>
          <p class="tip-text">{{ healthTip.content }}</p>
          <button class="btn-learn-more">Learn More</button>
        </section>
      </div>
    </div>
  </main>
</div>

